<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>DOMAIN-DOMAIN CONTACT INTERFACE EXTRACTION &#8212; CoDIAC 1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css?v=514cf933" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    
    <script src="../_static/documentation_options.js?v=29a6c3e3"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">CoDIAC 1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">DOMAIN-DOMAIN CONTACT INTERFACE EXTRACTION</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">CoDIAC</span> <span class="kn">import</span> <span class="n">contactMap</span> <span class="k">as</span> <span class="n">cm</span>
<span class="kn">from</span> <span class="nn">CoDIAC</span> <span class="kn">import</span> <span class="n">PDBHelper</span>
<span class="kn">from</span> <span class="nn">CoDIAC</span> <span class="kn">import</span> <span class="n">pTyrLigand_helpers</span> <span class="k">as</span> <span class="n">pTyr_helpers</span>
</pre></div>
</div>
</div>
<section id="DOMAIN-DOMAIN-CONTACT-INTERFACE-EXTRACTION">
<h1>DOMAIN-DOMAIN CONTACT INTERFACE EXTRACTION<a class="headerlink" href="#DOMAIN-DOMAIN-CONTACT-INTERFACE-EXTRACTION" title="Link to this heading">¶</a></h1>
<section id="STEP-1:-Fetching-data-from-PDB-reference-file-for-a-PDB-examined">
<h2>STEP 1: Fetching data from PDB reference file for a PDB examined<a class="headerlink" href="#STEP-1:-Fetching-data-from-PDB-reference-file-for-a-PDB-examined" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">PATH</span> <span class="o">=</span> <span class="s1">&#39;./Data/Adjacency_files/&#39;</span> <span class="c1">#this is where you can find the adjacency files</span>
<span class="n">ann_file</span> <span class="o">=</span> <span class="s1">&#39;./Data/PDB_Reference/SH2_IPR000980_PDB_reference.csv&#39;</span> <span class="c1">#this is the annotation file</span>
<span class="n">PDB_ID</span> <span class="o">=</span> <span class="s1">&#39;4JGH&#39;</span> <span class="c1">#SOCS family protein</span>

<span class="n">ann</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">ann_file</span><span class="p">)</span>
<span class="n">entities</span> <span class="o">=</span> <span class="n">PDBHelper</span><span class="o">.</span><span class="n">PDBEntitiesClass</span><span class="p">(</span><span class="n">ann</span><span class="p">,</span> <span class="n">PDB_ID</span><span class="p">)</span>
<span class="n">entity</span> <span class="o">=</span><span class="mi">1</span> <span class="c1">#there&#39;s only one entity in this example</span>
<span class="n">pdbClass</span> <span class="o">=</span> <span class="n">entities</span><span class="o">.</span><span class="n">pdb_dict</span><span class="p">[</span><span class="n">entity</span><span class="p">]</span> <span class="c1">#this holds information about the protein crystalized, such as domains</span>
<span class="n">chain_A</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">chainMap</span><span class="p">(</span><span class="n">PDB_ID</span><span class="p">,</span> <span class="n">entity</span><span class="p">)</span>
<span class="n">chain_A</span><span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="n">PATH</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;struct sequence:&#39;</span><span class="p">,</span> <span class="n">chain_A</span><span class="o">.</span><span class="n">structSeq</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;minimum residue number:&#39;</span><span class="p">,</span> <span class="n">chain_A</span><span class="o">.</span><span class="n">return_min_residue</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;length of residues in seq:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">chain_A</span><span class="o">.</span><span class="n">resNums</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;residue array size:&#39;</span><span class="p">,</span> <span class="n">chain_A</span><span class="o">.</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;unmodelled residues list:&#39;</span><span class="p">,</span><span class="n">chain_A</span><span class="o">.</span><span class="n">unmodeled_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
struct sequence: HMDPEFQAARLAKALRELGQTGWYWGSMTVNEAKEKLKEAPEGTFLIRDSSHSDYLLTISVKTSAGPTNLRIEYQDGKFRLDSIICVKSKLKQFDSVVHLIDYYVQMCKD----------GTVHLYLTKPLYTSAPSLQHLCRLTINKCTGAIWGLPLPTRLKDYLEEYKFQV
minimum residue number: 26
length of residues in seq: 173
residue array size: (173, 173)
unmodelled residues list: [136, 145]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pdbClass</span><span class="o">.</span><span class="n">ref_seq_mutated</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pdbClass</span><span class="o">.</span><span class="n">ref_seq_positions</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pdbClass</span><span class="o">.</span><span class="n">ref_seq_mutated</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
QAARLAKALRELGQTGWYWGSMTVNEAKEKLKEAPEGTFLIRDSSHSDYLLTISVKTSAGPTNLRIEYQDGKFRLDSIICVKSKLKQFDSVVHLIDYYVQMCKDKRTGPEAPRNGTVHLYLTKPLYTSAPSLQHLCRLTINKCTGAIWGLPLPTRLKDYLEEYKFQV
32
167
</pre></div></div>
</div>
</section>
<section id="STEP2:-Create-an-entity-specific-class-to-align-structure-to-reference-sequence-positions">
<h2>STEP2: Create an entity specific class to align structure to reference sequence positions<a class="headerlink" href="#STEP2:-Create-an-entity-specific-class-to-align-structure-to-reference-sequence-positions" title="Link to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chain_A_aligned</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">translate_chainMap_to_RefSeq</span><span class="p">(</span><span class="n">chain_A</span><span class="p">,</span> <span class="n">pdbClass</span><span class="p">)</span> <span class="c1">#class created to align structure to reference sequence positions</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Deleting 6 amino acids
Adding 1 c-terminal gaps
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#These are the domains that are available in the structure for analysis</span>
<span class="n">pdbClass</span><span class="o">.</span><span class="n">domains</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{0: {&#39;SH2&#39;: [46, 156, 0, 0]}, 1: {&#39;SOCS_box&#39;: [151, 197, 0, 0]}}
</pre></div></div>
</div>
</section>
<section id="STEP-3:-Identify-domain-boundaries">
<h2>STEP 3: Identify domain boundaries<a class="headerlink" href="#STEP-3:-Identify-domain-boundaries" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ROI_1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">46</span><span class="p">,</span> <span class="mi">156</span><span class="p">]</span> <span class="c1">#SH2 domain</span>
<span class="n">ROI_2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">151</span><span class="p">,</span> <span class="mi">197</span><span class="p">]</span> <span class="c1">#socsbox domain</span>
<span class="n">fastaHeader</span> <span class="o">=</span> <span class="s1">&#39;SH2|SOCS_box&#39;</span>
</pre></div>
</div>
</div>
</section>
<section id="STEP-4:-Generate-fasta/feature-files-for-jalview-visualization">
<h2>STEP 4: Generate fasta/feature files for jalview visualization<a class="headerlink" href="#STEP-4:-Generate-fasta/feature-files-for-jalview-visualization" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chain_A_aligned</span><span class="o">.</span><span class="n">print_fasta_feature_files</span><span class="p">(</span><span class="n">ROI_1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span> <span class="n">ROI_1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ROI_2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span><span class="n">ROI_2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;O14508|SOCS2|1|46|156&#39;</span><span class="p">,</span> <span class="s1">&#39;SOCS_box&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;./Data/Feature_Fasta_files/SH2_interdomain_4JGH&#39;</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_ref_seq_aligned</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#another visualization of contacts between regions of interest</span>
<span class="n">chain_A_aligned</span><span class="o">.</span><span class="n">generateAnnotatedHeatMap</span><span class="p">(</span><span class="n">ROI_2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ROI_2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ROI_1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ROI_1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">remove_no_contacts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Examples_contacts_extraction_13_0.png" src="../_images/Examples_contacts_extraction_13_0.png" />
</div>
</div>
</section>
</section>
<section id="LIGAND-INTERFACE-CONTACT-EXTRACTION">
<h1>LIGAND INTERFACE CONTACT EXTRACTION<a class="headerlink" href="#LIGAND-INTERFACE-CONTACT-EXTRACTION" title="Link to this heading">¶</a></h1>
<section id="STEP-1:Identity-PTMS-from-PDB-reference-file-for-a-specific-PDB">
<h2>STEP 1:Identity PTMS from PDB reference file for a specific PDB<a class="headerlink" href="#STEP-1:Identity-PTMS-from-PDB-reference-file-for-a-specific-PDB" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">main</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">ann_file</span><span class="p">)</span>
<span class="n">PDB_ID</span><span class="o">=</span><span class="s1">&#39;3TL0&#39;</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">main</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;PDB_ID&#39;</span><span class="p">):</span>

    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">group</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="n">PDB_ID</span><span class="p">:</span>
            <span class="n">modification_from_PDB</span> <span class="o">=</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;modifications&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;modifications&#39;</span><span class="p">],</span><span class="nb">str</span><span class="p">):</span> <span class="c1">#PTM dictionary</span>
                <span class="n">transDict</span> <span class="o">=</span> <span class="n">PDBHelper</span><span class="o">.</span><span class="n">return_PTM_dict</span><span class="p">(</span><span class="n">modification_from_PDB</span><span class="p">)</span> <span class="c1">#dictionary with ptm information from PDB reference file</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">transDict</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{4: &#39;PTR&#39;}
</pre></div></div>
</div>
</section>
<section id="STEP-2:-Generate-single-dictionary-of-contact-map-for-each-entity-in-the-structure">
<h2>STEP 2: Generate single dictionary of contact map for each entity in the structure<a class="headerlink" href="#STEP-2:-Generate-single-dictionary-of-contact-map-for-each-entity-in-the-structure" title="Link to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lig_entity</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">SH2_entity</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">dict_of_lig</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">return_single_chain_dict</span><span class="p">(</span><span class="n">main</span><span class="p">,</span> <span class="n">PDB_ID</span><span class="p">,</span> <span class="n">PATH</span><span class="p">,</span> <span class="n">lig_entity</span><span class="p">)</span>
<span class="n">dict_of_SH2</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">return_single_chain_dict</span><span class="p">(</span><span class="n">main</span><span class="p">,</span> <span class="n">PDB_ID</span><span class="p">,</span> <span class="n">PATH</span><span class="p">,</span> <span class="n">SH2_entity</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
3
Adding 1 n_term positions
Adding 2 c-terminal gaps
6
Adding 4 n_term positions
Adding 3 c-terminal gaps
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dict_of_lig</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;entity&#39;: 2,
 &#39;PDB_ID&#39;: &#39;3TL0&#39;,
 &#39;pdb_class&#39;: &lt;CoDIAC.PDBHelper.PDBClass at 0x7fd119898310&gt;,
 &#39;cm&#39;: &lt;CoDIAC.contactMap.chainMap at 0x7fd10a013ee0&gt;,
 &#39;cm_aligned&#39;: &lt;CoDIAC.contactMap.chainMap at 0x7fd108c29e20&gt;}
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cm_aligned</span> <span class="o">=</span> <span class="n">dict_of_lig</span><span class="p">[</span><span class="s1">&#39;cm_aligned&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cm_aligned</span><span class="o">.</span><span class="vm">__dict__</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;PDB_ID&#39;: &#39;3TL0&#39;,
 &#39;entity&#39;: 2,
 &#39;aaRes_dict&#39;: {},
 &#39;arr&#39;: array([[0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
        [0., 0., 1., 1., 0., 0., 0., 0., 0., 0.],
        [0., 1., 0., 1., 0., 0., 0., 0., 0., 0.],
        [0., 1., 1., 0., 1., 0., 0., 0., 0., 0.],
        [0., 0., 0., 1., 0., 1., 1., 0., 0., 0.],
        [0., 0., 0., 0., 1., 0., 1., 0., 0., 0.],
        [0., 0., 0., 0., 1., 1., 0., 1., 0., 0.],
        [0., 0., 0., 0., 0., 0., 1., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]]),
 &#39;transDict&#39;: {4: &#39;PTR&#39;},
 &#39;structSeq&#39;: &#39;RLNYAQLWHR&#39;,
 &#39;resNums&#39;: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
 &#39;adjacencyDict&#39;: {2: {3: 1, 4: 1},
  3: {4: 1},
  4: {5: 1},
  5: {6: 1, 7: 1},
  6: {7: 1},
  7: {8: 1}},
 &#39;unmodeled_list&#39;: [1, 1, 8, 10],
 &#39;match&#39;: True,
 &#39;offset&#39;: 198,
 &#39;ERROR_CODE&#39;: 0,
 &#39;refseq&#39;: &#39;RLNYAQLWHR&#39;}
</pre></div></div>
</div>
</section>
<section id="STEP-3:-Select-the-ligand-length-by-specifying-no-of-residues-N-and-C-terminal-of-PTM-of-interest-('y'-pTyr)">
<h2>STEP 3: Select the ligand length by specifying no of residues N and C terminal of PTM of interest (‘y’-pTyr)<a class="headerlink" href="#STEP-3:-Select-the-ligand-length-by-specifying-no-of-residues-N-and-C-terminal-of-PTM-of-interest-('y'-pTyr)" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">PTM</span><span class="o">=</span><span class="s1">&#39;PTR&#39;</span>
<span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">cm_aligned</span><span class="o">.</span><span class="n">transDict</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">cm_aligned</span><span class="o">.</span><span class="n">resNums</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">PTM</span> <span class="ow">in</span> <span class="n">cm_aligned</span><span class="o">.</span><span class="n">transDict</span><span class="p">[</span><span class="n">res</span><span class="p">]:</span>
            <span class="n">res_start</span><span class="p">,</span> <span class="n">res_end</span><span class="p">,</span> <span class="n">aligned_str</span><span class="p">,</span> <span class="n">tick_labels</span> <span class="o">=</span> <span class="n">pTyr_helpers</span><span class="o">.</span><span class="n">return_pos_of_interest</span><span class="p">(</span>
                <span class="n">cm_aligned</span><span class="o">.</span><span class="n">resNums</span><span class="p">,</span> <span class="n">cm_aligned</span><span class="o">.</span><span class="n">structSeq</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">n_term_num</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">c_term_num</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">PTR_value</span> <span class="o">=</span> <span class="s1">&#39;y&#39;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res_start</span><span class="p">,</span> <span class="n">res_end</span><span class="p">,</span> <span class="n">aligned_str</span><span class="p">,</span> <span class="n">tick_labels</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1,
 9,
 &#39;--RLNyAQLWH&#39;,
 [&#39;R-3&#39;, &#39;L-2&#39;, &#39;N-1&#39;, &#39;y0&#39;, &#39;A1&#39;, &#39;Q2&#39;, &#39;L3&#39;, &#39;W4&#39;, &#39;H5&#39;, &#39;R10&#39;])
</pre></div></div>
</div>
</section>
<section id="STEP-4:-Generate-contacts-between-two-single-entity-dictionaries-with-contactmaps-(domains-and-ligands-on-different-entities)">
<h2>STEP 4: Generate contacts between two single entity dictionaries with contactmaps (domains and ligands on different entities)<a class="headerlink" href="#STEP-4:-Generate-contacts-between-two-single-entity-dictionaries-with-contactmaps-(domains-and-ligands-on-different-entities)" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adjList</span><span class="p">,</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">return_interChain_adj</span><span class="p">(</span><span class="n">PATH</span><span class="p">,</span> <span class="n">dict_of_lig</span><span class="p">,</span> <span class="n">dict_of_SH2</span><span class="p">)</span> <span class="c1">#outer dict keys for ligand residues - ligand to domain contacts</span>
<span class="n">adjList_alt</span><span class="p">,</span> <span class="n">arr_alt</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">return_interChain_adj</span><span class="p">(</span><span class="n">PATH</span><span class="p">,</span> <span class="n">dict_of_SH2</span><span class="p">,</span> <span class="n">dict_of_lig</span><span class="p">)</span> <span class="c1">#outer dict keys for SH2 domain - domain to ligand contacts</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adjList</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{2: {14: 1, 17: 1},
 4: {32: 1, 34: 1, 35: 1, 36: 1, 42: 1, 53: 1, 55: 1},
 3: {52: 1, 53: 1},
 5: {52: 1, 53: 1, 54: 1, 90: 1, 96: 1},
 7: {54: 1, 65: 1, 88: 1, 89: 1, 90: 1, 96: 1},
 8: {89: 1},
 6: {90: 1, 91: 1}}
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#fetching start and end residue positions of domains and ligands</span>
<span class="n">domains</span> <span class="o">=</span> <span class="n">dict_of_SH2</span><span class="p">[</span><span class="s1">&#39;pdb_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">domains</span>
<span class="n">SH2_start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">domains</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;SH2&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">SH2_stop</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">domains</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;SH2&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
<span class="n">arr_sub</span><span class="p">,</span> <span class="n">list_aa_from_sub</span><span class="p">,</span> <span class="n">list_to_aa_sub</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">return_arr_subset_by_ROI</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span>
                                                                 <span class="n">res_start</span><span class="p">,</span> <span class="n">res_end</span><span class="p">,</span> <span class="n">dict_of_lig</span><span class="p">[</span><span class="s1">&#39;cm_aligned&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">return_min_residue</span><span class="p">(),</span>
                                                                 <span class="n">SH2_start</span><span class="p">,</span> <span class="n">SH2_stop</span><span class="p">,</span> <span class="n">dict_of_SH2</span><span class="p">[</span><span class="s1">&#39;cm_aligned&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">return_min_residue</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SH2_start</span><span class="p">,</span> <span class="n">SH2_stop</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(4, 102)
</pre></div></div>
</div>
</section>
<section id="STEP-5:-Generate-fasta/feature-files-for-jalview-visualization">
<h2>STEP 5: Generate fasta/feature files for jalview visualization<a class="headerlink" href="#STEP-5:-Generate-fasta/feature-files-for-jalview-visualization" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SH2 domain-centric contacts</span>
<span class="n">fasta_header</span> <span class="o">=</span> <span class="s1">&#39;Q06124|PTPN11|1|4|102|lig_4&#39;</span>
<span class="n">PTM_file</span> <span class="o">=</span> <span class="s1">&#39;./Data/Feature_Fasta_files/SH2_ligand_3TL0_test&#39;</span>
<span class="n">cm</span><span class="o">.</span><span class="n">print_fasta_feature_files</span><span class="p">(</span><span class="n">arr_alt</span><span class="p">,</span> <span class="n">dict_of_SH2</span><span class="p">[</span><span class="s1">&#39;cm_aligned&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">refseq</span><span class="p">,</span>
                                                            <span class="n">SH2_start</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">SH2_stop</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">dict_of_SH2</span><span class="p">[</span><span class="s1">&#39;cm_aligned&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">return_min_residue</span><span class="p">(),</span>
                                                            <span class="n">res_start</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">res_end</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">dict_of_lig</span><span class="p">[</span><span class="s1">&#39;cm_aligned&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">return_min_residue</span><span class="p">(),</span>
                                                            <span class="n">fasta_header</span><span class="p">,</span><span class="s1">&#39;pTyr&#39;</span><span class="p">,</span> <span class="n">PTM_file</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#pTyr ligand-centric contacts</span>
<span class="n">SH2_file</span> <span class="o">=</span> <span class="s1">&#39;./Data/Feature_Fasta_files/pTyr_3TL0_test&#39;</span>
<span class="n">cm</span><span class="o">.</span><span class="n">print_fasta_feature_files</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">dict_of_lig</span><span class="p">[</span><span class="s1">&#39;cm_aligned&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">structSeq</span><span class="p">,</span>
                                                                 <span class="n">res_start</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="n">res_end</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">dict_of_lig</span><span class="p">[</span><span class="s1">&#39;cm_aligned&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">return_min_residue</span><span class="p">(),</span>
                                                                 <span class="n">SH2_start</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">SH2_stop</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">dict_of_SH2</span><span class="p">[</span><span class="s1">&#39;cm_aligned&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">return_min_residue</span><span class="p">(),</span>
                                                                <span class="n">fasta_header</span><span class="p">,</span><span class="s1">&#39;SH2&#39;</span><span class="p">,</span> <span class="n">SH2_file</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">True</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">DOMAIN-DOMAIN CONTACT INTERFACE EXTRACTION</a><ul>
<li><a class="reference internal" href="#STEP-1:-Fetching-data-from-PDB-reference-file-for-a-PDB-examined">STEP 1: Fetching data from PDB reference file for a PDB examined</a></li>
<li><a class="reference internal" href="#STEP2:-Create-an-entity-specific-class-to-align-structure-to-reference-sequence-positions">STEP2: Create an entity specific class to align structure to reference sequence positions</a></li>
<li><a class="reference internal" href="#STEP-3:-Identify-domain-boundaries">STEP 3: Identify domain boundaries</a></li>
<li><a class="reference internal" href="#STEP-4:-Generate-fasta/feature-files-for-jalview-visualization">STEP 4: Generate fasta/feature files for jalview visualization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#LIGAND-INTERFACE-CONTACT-EXTRACTION">LIGAND INTERFACE CONTACT EXTRACTION</a><ul>
<li><a class="reference internal" href="#STEP-1:Identity-PTMS-from-PDB-reference-file-for-a-specific-PDB">STEP 1:Identity PTMS from PDB reference file for a specific PDB</a></li>
<li><a class="reference internal" href="#STEP-2:-Generate-single-dictionary-of-contact-map-for-each-entity-in-the-structure">STEP 2: Generate single dictionary of contact map for each entity in the structure</a></li>
<li><a class="reference internal" href="#STEP-3:-Select-the-ligand-length-by-specifying-no-of-residues-N-and-C-terminal-of-PTM-of-interest-('y'-pTyr)">STEP 3: Select the ligand length by specifying no of residues N and C terminal of PTM of interest (‘y’-pTyr)</a></li>
<li><a class="reference internal" href="#STEP-4:-Generate-contacts-between-two-single-entity-dictionaries-with-contactmaps-(domains-and-ligands-on-different-entities)">STEP 4: Generate contacts between two single entity dictionaries with contactmaps (domains and ligands on different entities)</a></li>
<li><a class="reference internal" href="#STEP-5:-Generate-fasta/feature-files-for-jalview-visualization">STEP 5: Generate fasta/feature files for jalview visualization</a></li>
</ul>
</li>
</ul>

  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/Examples/contacts_extraction.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">CoDIAC 1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">DOMAIN-DOMAIN CONTACT INTERFACE EXTRACTION</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2023, Naegle Lab.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>