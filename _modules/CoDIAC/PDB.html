<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CoDIAC.PDB &#8212; CoDIAC 1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../../_static/classic.css?v=514cf933" />
    
    <script src="../../_static/documentation_options.js?v=29a6c3e3"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">CoDIAC 1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">CoDIAC.PDB</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for CoDIAC.PDB</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">COLUMNS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PDB_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;ENTITY_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;CHAIN_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;pdbx_description&#39;</span><span class="p">,</span>  <span class="s1">&#39;rcsb_gene_name&#39;</span><span class="p">,</span> <span class="s1">&#39;pdbx_gene_src_scientific_name&#39;</span><span class="p">,</span>
            <span class="s1">&#39;pdbx_seq_one_letter_code&#39;</span><span class="p">,</span> <span class="s1">&#39;pdbx_seq_one_letter_code_can&#39;</span><span class="p">,</span> <span class="s1">&#39;rcsb_sample_sequence_length&#39;</span><span class="p">,</span>
            <span class="s1">&#39;modifications locations&#39;</span><span class="p">,</span><span class="s1">&#39;modifications&#39;</span><span class="p">,</span>  <span class="s1">&#39;rcsb_entity_polymer_type&#39;</span><span class="p">,</span> <span class="s1">&#39;macromolecular_type&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;database_name&#39;</span><span class="p">,</span> <span class="s1">&#39;database_accession&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;rcsb_uniprot_protein_sequence&#39;</span><span class="p">,</span>  <span class="s1">&#39;entity_beg_seq_id&#39;</span><span class="p">,</span> <span class="s1">&#39;ref_beg_seq_id&#39;</span><span class="p">,</span><span class="s1">&#39;aligned_regions_length&#39;</span><span class="p">,</span>
            <span class="s1">&#39;mutations exist (Y/N)&#39;</span><span class="p">,</span><span class="s1">&#39;rcsb_mutation_count&#39;</span><span class="p">,</span><span class="s1">&#39;mutations locations&#39;</span><span class="p">,</span> <span class="s1">&#39;pdbx_mutation joined&#39;</span><span class="p">,</span>
            <span class="s1">&#39;molecular_weight&#39;</span><span class="p">,</span> <span class="s1">&#39;experimental_method&#39;</span><span class="p">,</span> <span class="s1">&#39;resolution_combined&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;deposit_date&#39;</span><span class="p">,</span> <span class="s1">&#39;audit_author_name&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">,</span><span class="s1">&#39;pdbx_database_id_doi&#39;</span><span class="p">,</span><span class="s1">&#39;pdbx_database_id_pub_med&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="PDB_interface">
<a class="viewcode-back" href="../../PDB.html#CoDIAC.PDB.PDB_interface">[docs]</a>
<span class="k">class</span> <span class="nc">PDB_interface</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class that obtains and outputs relevant metadata/annotations for individual PDB IDs in the form of a dictionary</span>
<span class="sd">    and/or a csv file.</span>
<span class="sd">    </span>
<span class="sd">    Attributes</span>
<span class="sd">    -----------</span>
<span class="sd">    PDB_list : list of strings</span>
<span class="sd">        list of PDB IDs (4-character alphanumeric identifier) that the user wants to gather information on</span>
<span class="sd">    </span>
<span class="sd">    Methods</span>
<span class="sd">    --------</span>
<span class="sd">    get_anno_dict</span>
<span class="sd">        Produces a dictionary full of the annotations for all of the PDB IDs from the inputted csv file.</span>
<span class="sd">    print_output_csv</span>
<span class="sd">        Produces a csv file (to the location of the inputted file path) full of the annotations for all of the pdb ids</span>
<span class="sd">        from the inputted csv file.</span>
<span class="sd">    get_all</span>
<span class="sd">        Produces a dictionary, csv file, &amp; Excel file (to the location of the input file path) full of the annotations</span>
<span class="sd">        for all of the pdb ids from the inputted csv file.</span>
<span class="sd">    </span>
<span class="sd">	</span>
<span class="sd">	&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">PDB_list</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor for the PDB_interface class.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        PDB_list : list of strings</span>
<span class="sd">            list of PDB IDs (4-character alphanumeric identifier) that the user wants to gather information on</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PDB_list</span> <span class="o">=</span> <span class="n">PDB_list</span>

       
<div class="viewcode-block" id="PDB_interface.get_anno_dict">
<a class="viewcode-back" href="../../PDB.html#CoDIAC.PDB.PDB_interface.get_anno_dict">[docs]</a>
    <span class="k">def</span> <span class="nf">get_anno_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Produces a dictionary full of the annotations for all of the PDB IDs from the PDB List of IDs used to instantiate the object</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        overall_dict : dictionary</span>
<span class="sd">            dictionary full of the annotations for all of the pdb ids from the inputted file</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">IDs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PDB_list</span>
        
        <span class="n">overall_dict</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="k">for</span> <span class="n">each_id</span> <span class="ow">in</span> <span class="n">IDs</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PDB_metadata</span><span class="p">(</span><span class="n">each_id</span><span class="p">)</span>
                <span class="n">annotated_dict</span> <span class="o">=</span> <span class="n">metadata</span><span class="o">.</span><span class="n">set_PDB_API_annotation</span><span class="p">()</span>
                <span class="n">overall_dict</span><span class="p">[</span><span class="n">each_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">annotated_dict</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">each_id</span> <span class="o">+</span> <span class="s1">&#39; is not a valid PDB ID&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">overall_dict</span></div>



    
<div class="viewcode-block" id="PDB_interface.print_output_csv">
<a class="viewcode-back" href="../../PDB.html#CoDIAC.PDB.PDB_interface.print_output_csv">[docs]</a>
    <span class="k">def</span> <span class="nf">print_output_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outputFile</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Produces a csv file (to the location of the inputted file path) full of the annotations for all of the pdb ids</span>
<span class="sd">        from the inputted csv file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        outputFile : string</span>
<span class="sd">            name of the csv file you want to generate</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">overall_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_anno_dict</span><span class="p">()</span>
        <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">each_key</span> <span class="ow">in</span> <span class="n">overall_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">each_entity</span> <span class="ow">in</span> <span class="n">overall_dict</span><span class="p">[</span><span class="n">each_key</span><span class="p">]:</span>
                <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">each_entity</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_list</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">COLUMNS</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">outputFile</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;.csv&#39;</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">outputFile</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">outputFile</span> <span class="o">+</span> <span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="PDB_interface.get_all">
<a class="viewcode-back" href="../../PDB.html#CoDIAC.PDB.PDB_interface.get_all">[docs]</a>
    <span class="k">def</span> <span class="nf">get_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Produces a dictionary and csv file  full of the annotations</span>
<span class="sd">        for all of the pdb ids from the inputted csv file.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        overall_dict : dictionary</span>
<span class="sd">            dictionary full of the annotations for all of the pdb ids from the inputted file</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">csv_file_name</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Enter a file name for the output csv file: &#39;</span><span class="p">)</span>
        <span class="n">overall_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_anno_dict</span><span class="p">()</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">overall_dict</span><span class="p">)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csv_file_name</span> <span class="o">+</span> <span class="s1">&#39;.csv&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">overall_dict</span></div>


<div class="viewcode-block" id="PDB_interface.PDB_metadata">
<a class="viewcode-back" href="../../PDB.html#CoDIAC.PDB.PDB_interface.PDB_metadata">[docs]</a>
    <span class="k">class</span> <span class="nc">PDB_metadata</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A class that stores relevant metadata for individual PDB IDs.</span>
<span class="sd">        </span>
<span class="sd">        Attributes</span>
<span class="sd">        -----------</span>
<span class="sd">        meta_data_categories : list</span>
<span class="sd">            A defined list of relevant metadata categories from PDB that this class will store</span>
<span class="sd">        PDB_ID : string</span>
<span class="sd">            the PDB ID (4-character alphanumeric identifier) that the user wants to gather information on</span>
<span class="sd">        entry_dict : dictionary</span>
<span class="sd">            stores information from the entry service for the PDB_ID</span>
<span class="sd">        pubmed_dict : dictionary</span>
<span class="sd">            stores the pubmed annotations (data integrated from PubMed) for the PDB_ID</span>
<span class="sd">        schema_dict : dictionary</span>
<span class="sd">            stores information from the entry schema for the PDB_ID</span>
<span class="sd">        schema_uniprot_dict : dictionary</span>
<span class="sd">            stores information from the uniprot schema for the PDB_ID</span>
<span class="sd">        overall_polymer_entity_dict : dictionary</span>
<span class="sd">            stores polymer entity data for each entity id corresponding with the PDB_ID</span>
<span class="sd">        overall_uniprot_dict : dictionary</span>
<span class="sd">            stores UniProt annotations for a given macromolecular entity (each entity id corresponding with the PDB_ID)</span>
<span class="sd">                        </span>
<span class="sd">        Methods</span>
<span class="sd">        --------</span>
<span class="sd">        set_PDB_API_annotation</span>
<span class="sd">            Utilizes other class methods to generate dictionaries of information for a PDB ID, find the correct information</span>
<span class="sd">            (&quot;value&quot;) for each attibute (&quot;key&quot;) for that PDB ID, and store the key-value pairs in a dictionary containing</span>
<span class="sd">            all the desired information for that PDB ID.</span>
<span class="sd">        get_empty_anno_dict</span>
<span class="sd">            Creates a dictionary with the attributes contained in meta_data as keys with empty values.</span>
<span class="sd">        get_all_dicts</span>
<span class="sd">            Obtains information from the PDB API for a specific PDB ID and stores it in dictionaries.</span>
<span class="sd">        get_annotation</span>
<span class="sd">            Finds and returns the corresponding information for the specified attribute of the PDB ID.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">meta_data_categories</span> <span class="o">=</span> <span class="n">COLUMNS</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">PDB_ID</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Constructor for the PDB_metadata class which takes in a PDB ID and generates global metadata dictionaries for it.</span>
<span class="sd">            </span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            PDB_ID : string</span>
<span class="sd">                the PDB ID (4-character alphanumeric identifier) that the user wants to gather information on</span>
<span class="sd">            </span>
<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None.</span>

<span class="sd">            &quot;&quot;&quot;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">PDB_ID</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">entry_dict</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pubmed_dict</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">schema_dict</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">schema_uniprot_dict</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">overall_polymer_entity_dict</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">overall_uniprot_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_dicts</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mods</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">locs</span> <span class="o">=</span> <span class="p">{}</span>

<div class="viewcode-block" id="PDB_interface.PDB_metadata.set_PDB_API_annotation">
<a class="viewcode-back" href="../../PDB.html#CoDIAC.PDB.PDB_interface.PDB_metadata.set_PDB_API_annotation">[docs]</a>
        <span class="k">def</span> <span class="nf">set_PDB_API_annotation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Utilizes other class methods to generate dictionaries of information for a PDB ID, find the correct information</span>
<span class="sd">            (&quot;value&quot;) for each attibute (&quot;key&quot;) for that PDB ID, and store the key-value pairs in a dictionary containing</span>
<span class="sd">            all the desired information for that PDB ID.</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            anno_dict : dictionary</span>
<span class="sd">                dictionary storing all information for the PDB_ID</span>

<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">anno_dict_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">entity_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry_dict</span><span class="p">[</span><span class="s1">&#39;rcsb_entry_container_identifiers&#39;</span><span class="p">][</span><span class="s1">&#39;polymer_entity_ids&#39;</span><span class="p">]:</span>
                <span class="n">anno_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_empty_anno_dict</span><span class="p">()</span>
                
                <span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="n">anno_dict</span><span class="p">:</span>
                    <span class="n">anno_dict</span><span class="p">[</span><span class="n">attribute</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_annotation</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">entity_id</span><span class="p">)</span>

                <span class="n">anno_dict_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">anno_dict</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">anno_dict_list</span></div>


<div class="viewcode-block" id="PDB_interface.PDB_metadata.get_empty_anno_dict">
<a class="viewcode-back" href="../../PDB.html#CoDIAC.PDB.PDB_interface.PDB_metadata.get_empty_anno_dict">[docs]</a>
        <span class="k">def</span> <span class="nf">get_empty_anno_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Creates a dictionary with the attributes contained in meta_data as keys with empty values. </span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            inner : dictionary</span>
<span class="sd">                placeholder dictionary created before the values are added.</span>

<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">inner</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">meta_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meta_data_categories</span>
            <span class="k">for</span> <span class="n">meta</span> <span class="ow">in</span> <span class="n">meta_data</span><span class="p">:</span>
                <span class="n">inner</span><span class="p">[</span><span class="n">meta</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">return</span> <span class="n">inner</span></div>

    
        <span class="k">def</span> <span class="nf">find_mods</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">polymer_entity_id</span><span class="p">):</span>
            <span class="n">polymer_entity_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">overall_polymer_entity_dict</span><span class="p">[</span><span class="n">polymer_entity_id</span><span class="p">]</span>
            <span class="n">pdb_seq</span> <span class="o">=</span> <span class="n">polymer_entity_dict</span><span class="p">[</span><span class="s1">&#39;entity_poly&#39;</span><span class="p">][</span><span class="s1">&#39;pdbx_seq_one_letter_code&#39;</span><span class="p">]</span>
            <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">mods</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">locs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">while</span> <span class="n">pdb_seq</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="n">pdb_seq</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>
                <span class="n">end</span> <span class="o">=</span> <span class="n">pdb_seq</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
                <span class="n">mod</span> <span class="o">=</span> <span class="n">pdb_seq</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">end</span><span class="p">]</span>
                <span class="n">loc</span> <span class="o">=</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">offset</span>
                <span class="n">mod_loc</span> <span class="o">=</span> <span class="n">mod</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
                <span class="n">mods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mod_loc</span><span class="p">)</span>
                <span class="n">locs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">loc</span><span class="p">))</span>
                <span class="n">offset</span> <span class="o">=</span> <span class="n">offset</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">start</span> <span class="o">=</span> <span class="n">end</span>
            <span class="k">return</span> <span class="n">mods</span><span class="p">,</span> <span class="n">locs</span>
    
        <span class="k">def</span> <span class="nf">get_mod_locations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">polymer_entity_id</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">polymer_entity_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">locs</span><span class="p">:</span>
                <span class="n">locs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">locs</span><span class="p">[</span><span class="n">polymer_entity_id</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">mods</span><span class="p">,</span> <span class="n">locs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_mods</span><span class="p">(</span><span class="n">polymer_entity_id</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mods</span><span class="p">[</span><span class="n">polymer_entity_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">mods</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">locs</span><span class="p">[</span><span class="n">polymer_entity_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">locs</span>
            <span class="k">return</span> <span class="n">locs</span>
        
        <span class="k">def</span> <span class="nf">get_mod_types</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">polymer_entity_id</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">polymer_entity_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mods</span><span class="p">:</span>
                <span class="n">mods</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mods</span><span class="p">[</span><span class="n">polymer_entity_id</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">mods</span><span class="p">,</span> <span class="n">locs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_mods</span><span class="p">(</span><span class="n">polymer_entity_id</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mods</span><span class="p">[</span><span class="n">polymer_entity_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">mods</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">locs</span><span class="p">[</span><span class="n">polymer_entity_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">locs</span>                
            <span class="k">return</span> <span class="n">mods</span>

<div class="viewcode-block" id="PDB_interface.PDB_metadata.get_all_dicts">
<a class="viewcode-back" href="../../PDB.html#CoDIAC.PDB.PDB_interface.PDB_metadata.get_all_dicts">[docs]</a>
        <span class="k">def</span> <span class="nf">get_all_dicts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Obtains information from the PDB API for a specific PDB ID and stores it in dictionaries.</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            entry_dict : dictionary</span>
<span class="sd">                stores information from the entry service for the PDB_ID</span>
<span class="sd">            pubmed_dict : dictionary</span>
<span class="sd">                stores the pubmed annotations (data integrated from PubMed) for the PDB_ID</span>
<span class="sd">            schema_dict : dictionary</span>
<span class="sd">                stores information from the entry schema for the PDB_ID</span>
<span class="sd">            schema_uniprot_dict : dictionary</span>
<span class="sd">                stores information from the uniprot schema for the PDB_ID</span>
<span class="sd">            overall_polymer_entity_dict : dictionary</span>
<span class="sd">                stores polymer entity data for each entity id corresponding with the PDB_ID</span>
<span class="sd">            overall_uniprot_dict : dictionary</span>
<span class="sd">                stores UniProt annotations for a given macromolecular entity (each entity id corresponding with the PDB_ID)</span>

<span class="sd">            &quot;&quot;&quot;</span>

            <span class="n">PDB_ID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

            <span class="n">entry_url</span> <span class="o">=</span> <span class="s2">&quot;https://data.rcsb.org/rest/v1/core/entry/&quot;</span> <span class="o">+</span> <span class="n">PDB_ID</span>
            <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">entry_url</span><span class="p">)</span>
            <span class="n">entry_dict</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        
            <span class="n">pubmed_url</span> <span class="o">=</span> <span class="s2">&quot;https://data.rcsb.org/rest/v1/core/pubmed/&quot;</span> <span class="o">+</span> <span class="n">PDB_ID</span>
            <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pubmed_url</span><span class="p">)</span>
            <span class="n">pubmed_dict</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        
            <span class="n">schema_url</span> <span class="o">=</span> <span class="s2">&quot;https://data.rcsb.org/rest/v1/schema/entry&quot;</span> <span class="o">+</span> <span class="n">PDB_ID</span>
            <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">schema_url</span><span class="p">)</span>
            <span class="n">schema_dict</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        
            <span class="n">schema_uniprot_url</span> <span class="o">=</span> <span class="s2">&quot;https://data.rcsb.org/rest/v1/schema/uniprot&quot;</span> <span class="o">+</span> <span class="n">PDB_ID</span>
            <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">schema_uniprot_url</span><span class="p">)</span>
            <span class="n">schema_uniprot_dict</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        
            <span class="n">entry_id_dict</span> <span class="o">=</span> <span class="n">entry_dict</span><span class="p">[</span><span class="s1">&#39;entry&#39;</span><span class="p">]</span>
            <span class="n">ENTRY_ID</span> <span class="o">=</span> <span class="n">entry_id_dict</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
            <span class="n">rcsb_entry_container_identifiers</span> <span class="o">=</span> <span class="n">entry_dict</span><span class="p">[</span><span class="s1">&#39;rcsb_entry_container_identifiers&#39;</span><span class="p">]</span>
            <span class="n">ENTITY_IDS</span> <span class="o">=</span> <span class="n">rcsb_entry_container_identifiers</span><span class="p">[</span><span class="s1">&#39;entity_ids&#39;</span><span class="p">]</span>
            <span class="n">polymer_entity_ids</span> <span class="o">=</span> <span class="n">rcsb_entry_container_identifiers</span><span class="p">[</span><span class="s1">&#39;polymer_entity_ids&#39;</span><span class="p">]</span>
            <span class="n">nonpolymer_entity_ids</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">ENTITY_IDS</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">each</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">polymer_entity_ids</span><span class="p">:</span>
                    <span class="n">nonpolymer_entity_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">each</span><span class="p">)</span>
        
            <span class="n">overall_polymer_entity_dict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">each_entity_id</span> <span class="ow">in</span> <span class="n">polymer_entity_ids</span><span class="p">:</span>
                <span class="n">polymer_entity_url</span> <span class="o">=</span> <span class="s2">&quot;https://data.rcsb.org/rest/v1/core/polymer_entity/&quot;</span> <span class="o">+</span> \
                    <span class="n">ENTRY_ID</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">each_entity_id</span>
                <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">polymer_entity_url</span><span class="p">)</span>
                <span class="n">polymer_entity_dict</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
                <span class="n">overall_polymer_entity_dict</span><span class="p">[</span><span class="n">each_entity_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">polymer_entity_dict</span>
        
            <span class="n">overall_uniprot_dict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">each_entity_id</span> <span class="ow">in</span> <span class="n">ENTITY_IDS</span><span class="p">:</span>
                <span class="n">uniprot_url</span> <span class="o">=</span> <span class="s2">&quot;https://data.rcsb.org/rest/v1/core/uniprot/&quot;</span> <span class="o">+</span> \
                    <span class="n">ENTRY_ID</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">each_entity_id</span>
                <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">uniprot_url</span><span class="p">)</span>
                <span class="n">uniprot_dict</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
                <span class="n">overall_uniprot_dict</span><span class="p">[</span><span class="n">each_entity_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">uniprot_dict</span>
        
            <span class="k">return</span> <span class="n">entry_dict</span><span class="p">,</span> <span class="n">pubmed_dict</span><span class="p">,</span> <span class="n">schema_dict</span><span class="p">,</span> <span class="n">schema_uniprot_dict</span><span class="p">,</span> <span class="n">overall_polymer_entity_dict</span><span class="p">,</span> <span class="n">overall_uniprot_dict</span></div>


<div class="viewcode-block" id="PDB_interface.PDB_metadata.get_annotation">
<a class="viewcode-back" href="../../PDB.html#CoDIAC.PDB.PDB_interface.PDB_metadata.get_annotation">[docs]</a>
        <span class="k">def</span> <span class="nf">get_annotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">polymer_entity_id</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Finds and returns the corresponding information for the specified attribute of the PDB ID.</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            attribute : string</span>
<span class="sd">                each attribute is a specific piece of information wanted for the PDB_ID (attributes match the &quot;keys&quot; of the</span>
<span class="sd">                dictionaries created for each PDB_ID)</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            string</span>
<span class="sd">                string containing the corresponding information for that attribute.</span>
<span class="sd">                or string containing an error or N/A message when the desired information cannot be found/does not exist</span>
<span class="sd">            int</span>
<span class="sd">                int containing the corresponding information for that attribute.</span>
<span class="sd">                </span>
<span class="sd">            Raises</span>
<span class="sd">            --------</span>
<span class="sd">            KeyError if the desired information cannot be accessed, meaning a different pathway to access that information must be tried</span>
<span class="sd">            or that the desired information cannot be found/does not exist</span>

<span class="sd">            &quot;&quot;&quot;</span>
            
            <span class="n">PDB_ID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
            <span class="n">polymer_entity_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">overall_polymer_entity_dict</span><span class="p">[</span><span class="n">polymer_entity_id</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span> <span class="s1">&#39;PDB_ID&#39;</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">PDB_ID</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span> <span class="s1">&#39;ENTITY_ID&#39;</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">polymer_entity_id</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span> <span class="s1">&#39;CHAIN_ID&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polymer_entity_dict</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">entity_poly</span> <span class="o">=</span> <span class="n">polymer_entity_dict</span><span class="p">[</span><span class="s1">&#39;entity_poly&#39;</span><span class="p">]</span>
                        <span class="n">CHAIN_ID</span> <span class="o">=</span> <span class="n">entity_poly</span><span class="p">[</span><span class="s1">&#39;pdbx_strand_id&#39;</span><span class="p">]</span>
                    <span class="k">return</span> <span class="n">CHAIN_ID</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;not found&#39;</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span> <span class="s1">&#39;database_name&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polymer_entity_dict</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">rcsb_container_identifiers</span> <span class="o">=</span> <span class="n">polymer_entity_dict</span><span class="p">[</span><span class="s1">&#39;rcsb_polymer_entity_container_identifiers&#39;</span><span class="p">]</span>
                        <span class="n">reference_sequence_identifiers</span> <span class="o">=</span> <span class="n">rcsb_container_identifiers</span><span class="p">[</span><span class="s1">&#39;reference_sequence_identifiers&#39;</span><span class="p">]</span>
                        <span class="n">middle</span> <span class="o">=</span> <span class="n">reference_sequence_identifiers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">return</span> <span class="n">middle</span><span class="p">[</span><span class="s1">&#39;database_name&#39;</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;not found&#39;</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span> <span class="s1">&#39;rcsb_gene_name&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">rcsb_gene_nameS_list</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polymer_entity_dict</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">rcsb_entity_source_organism</span> <span class="o">=</span> <span class="n">polymer_entity_dict</span><span class="p">[</span><span class="s1">&#39;rcsb_entity_source_organism&#39;</span><span class="p">]</span>
                        <span class="n">middle</span> <span class="o">=</span> <span class="n">rcsb_entity_source_organism</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">rcsb_gene_name</span> <span class="o">=</span> <span class="n">middle</span><span class="p">[</span><span class="s1">&#39;rcsb_gene_name&#39;</span><span class="p">]</span>
                        <span class="k">for</span> <span class="n">each_dict</span> <span class="ow">in</span> <span class="n">rcsb_gene_name</span><span class="p">:</span>
                            <span class="n">gene_name</span> <span class="o">=</span> <span class="n">each_dict</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
                            <span class="k">if</span> <span class="n">gene_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rcsb_gene_nameS_list</span><span class="p">:</span>
                                <span class="n">rcsb_gene_nameS_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gene_name</span><span class="p">)</span>
                    <span class="k">return</span> <span class="s1">&#39;; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rcsb_gene_nameS_list</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;not found&#39;</span>
                    <span class="c1"># try:</span>
                    <span class="c1">#     rcsb_gene_nameS_list = []</span>
                    <span class="c1">#     for each_dict in self.overall_polymer_entity_dict.values():</span>
                    <span class="c1">#         if len(each_dict) &gt; 3:</span>
                    <span class="c1">#             entity_src_gen = each_dict[&#39;entity_src_gen&#39;]</span>
                    <span class="c1">#             middle = entity_src_gen[0]</span>
                    <span class="c1">#             all_names = (middle[&#39;pdbx_gene_src_gene&#39;]).split(&#39;, &#39;)</span>
                    <span class="c1">#             for each in all_names:</span>
                    <span class="c1">#                 rcsb_gene_nameS_list.append(each)</span>
                    <span class="c1">#     return &#39;,&#39;.join(rcsb_gene_nameS_list)</span>
                    <span class="c1"># except KeyError:</span>
                    <span class="c1">#     try:</span>
                    <span class="c1">#         for each_dict in self.overall_polymer_entity_dict.values():</span>
                    <span class="c1">#             if len(each_dict) &gt; 3:</span>
                    <span class="c1">#                 rcsb_entity_source_organism = each_dict[&#39;rcsb_entity_source_organism&#39;]</span>
                    <span class="c1">#                 middle = rcsb_entity_source_organism[0]</span>
                    <span class="c1">#         return middle[&#39;source_type&#39;]</span>
                    <span class="c1">#     except KeyError:</span>
                    <span class="c1">#         return &#39;not found&#39;</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span> <span class="s1">&#39;database_accession&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polymer_entity_dict</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">rcsb_container_identifiers</span> <span class="o">=</span> <span class="n">polymer_entity_dict</span><span class="p">[</span><span class="s1">&#39;rcsb_polymer_entity_container_identifiers&#39;</span><span class="p">]</span>
                        <span class="n">reference_sequence_identifiers</span> <span class="o">=</span> <span class="n">rcsb_container_identifiers</span><span class="p">[</span><span class="s1">&#39;reference_sequence_identifiers&#39;</span><span class="p">]</span>
                        <span class="n">middle</span> <span class="o">=</span> <span class="n">reference_sequence_identifiers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">return</span> <span class="n">middle</span><span class="p">[</span><span class="s1">&#39;database_accession&#39;</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;not found&#39;</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span> <span class="s1">&#39;pdbx_seq_one_letter_code&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">pdbx_seq_one_letter_code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polymer_entity_dict</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">3</span><span class="p">:</span>
                        <span class="n">entity_poly</span> <span class="o">=</span> <span class="n">polymer_entity_dict</span><span class="p">[</span><span class="s1">&#39;entity_poly&#39;</span><span class="p">]</span>
                        <span class="n">pdbx_seq_one_letter_code</span> <span class="o">=</span> <span class="n">entity_poly</span><span class="p">[</span><span class="s1">&#39;pdbx_seq_one_letter_code&#39;</span><span class="p">]</span>
                    <span class="k">return</span> <span class="n">pdbx_seq_one_letter_code</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;not found&#39;</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span> <span class="s1">&#39;rcsb_uniprot_protein_sequence&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">uniprot_entity_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">overall_uniprot_dict</span><span class="p">[</span><span class="n">polymer_entity_id</span><span class="p">]</span>
                    <span class="n">SEQ</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">uniprot_entity_dict</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">middle</span> <span class="o">=</span> <span class="n">uniprot_entity_dict</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">rcsb_uniprot_protein</span> <span class="o">=</span> <span class="n">middle</span><span class="p">[</span><span class="s1">&#39;rcsb_uniprot_protein&#39;</span><span class="p">]</span>
                        <span class="n">SEQ</span> <span class="o">=</span> <span class="n">rcsb_uniprot_protein</span><span class="p">[</span><span class="s1">&#39;sequence&#39;</span><span class="p">]</span>
                    <span class="k">return</span> <span class="n">SEQ</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;not found&#39;</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span> <span class="s1">&#39;rcsb_sample_sequence_length&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polymer_entity_dict</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">entity_poly</span> <span class="o">=</span> <span class="n">polymer_entity_dict</span><span class="p">[</span><span class="s1">&#39;entity_poly&#39;</span><span class="p">]</span>
                        <span class="n">sequence_length</span> <span class="o">=</span> <span class="n">entity_poly</span><span class="p">[</span><span class="s1">&#39;rcsb_sample_sequence_length&#39;</span><span class="p">]</span>
                    <span class="k">return</span> <span class="n">sequence_length</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;not found&#39;</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span> <span class="s1">&#39;rcsb_entity_polymer_type&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polymer_entity_dict</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">entity_poly</span> <span class="o">=</span> <span class="n">polymer_entity_dict</span><span class="p">[</span><span class="s1">&#39;entity_poly&#39;</span><span class="p">]</span>
                    <span class="k">return</span> <span class="n">entity_poly</span><span class="p">[</span><span class="s1">&#39;rcsb_entity_polymer_type&#39;</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;not found&#39;</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span> <span class="s1">&#39;macromolecular_type&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polymer_entity_dict</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">entity_poly</span> <span class="o">=</span> <span class="n">polymer_entity_dict</span><span class="p">[</span><span class="s1">&#39;entity_poly&#39;</span><span class="p">]</span>
                    <span class="k">return</span> <span class="n">entity_poly</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;not found&#39;</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span> <span class="s1">&#39;molecular_weight&#39;</span><span class="p">):</span>
                <span class="n">entry_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry_dict</span><span class="p">[</span><span class="s1">&#39;rcsb_entry_info&#39;</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">entry_info</span><span class="p">[</span><span class="s1">&#39;molecular_weight&#39;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span> <span class="s1">&#39;experimental_method&#39;</span><span class="p">):</span>
                <span class="n">entry_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry_dict</span><span class="p">[</span><span class="s1">&#39;rcsb_entry_info&#39;</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">entry_info</span><span class="p">[</span><span class="s1">&#39;experimental_method&#39;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span> <span class="s1">&#39;resolution_combined&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">summary</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry_dict</span><span class="p">[</span><span class="s1">&#39;rcsb_entry_info&#39;</span><span class="p">]</span>
                    <span class="c1"># need to check if more than one value is ever reported</span>
                    <span class="k">return</span> <span class="n">summary</span><span class="p">[</span><span class="s1">&#39;resolution_combined&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;not found&#39;</span>
            <span class="c1"># elif (attribute == &#39;pdbx_seq_one_letter_code_can&#39;):</span>
            <span class="c1">#     try:</span>

            <span class="c1">#         for each_dict in self.overall_uniprot_dict.values():</span>
            <span class="c1">#             if len(polymer_entity_dict) &lt; 3:</span>
            <span class="c1">#                 middle = each_dict[0]</span>
            <span class="c1">#                 rcsb_uniprot_protein = middle[&#39;rcsb_uniprot_protein&#39;]</span>
            <span class="c1">#                 SEQ = rcsb_uniprot_protein[&#39;sequence&#39;]</span>
            <span class="c1">#         REF_SEQ_POSITIONS_DICT = {&#39;Beginning Position on PDB Sequence&#39;: &#39;&#39;, &#39;Ref Sequence Length&#39;: &#39;&#39;}</span>
            <span class="c1">#         for each_dict in self.overall_polymer_entity_dict.values():</span>
            <span class="c1">#             if len(each_dict) &gt; 3:</span>
            <span class="c1">#                 entity_align = each_dict[&#39;rcsb_polymer_entity_align&#39;]</span>
            <span class="c1">#                 middle = entity_align[0]</span>
            <span class="c1">#                 aligned_info = middle[&#39;aligned_regions&#39;]</span>
            <span class="c1">#                 middle2 = aligned_info[0]</span>
            <span class="c1">#                 REF_SEQ_POSITIONS_DICT[&#39;Beginning Position on PDB Sequence&#39;] = middle2[&#39;entity_beg_seq_id&#39;]</span>
            <span class="c1">#                 REF_SEQ_POSITIONS_DICT[&#39;Ref Sequence Length&#39;] = middle2[&#39;length&#39;]</span>
            <span class="c1">#         beg_number = REF_SEQ_POSITIONS_DICT[&#39;Beginning Position on PDB Sequence&#39;]-1</span>
            <span class="c1">#         end_number = beg_number + REF_SEQ_POSITIONS_DICT[&#39;Ref Sequence Length&#39;]</span>
            <span class="c1">#         return SEQ[beg_number:end_number]</span>
            <span class="c1">#     except KeyError:</span>
            <span class="c1">#         return &#39;not found&#39;</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span> <span class="s1">&#39;pdbx_seq_one_letter_code_can&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">SEQ</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polymer_entity_dict</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">entity_poly</span> <span class="o">=</span> <span class="n">polymer_entity_dict</span><span class="p">[</span><span class="s1">&#39;entity_poly&#39;</span><span class="p">]</span>
                        <span class="n">SEQ</span> <span class="o">=</span> <span class="n">entity_poly</span><span class="p">[</span><span class="s1">&#39;pdbx_seq_one_letter_code_can&#39;</span><span class="p">]</span>
                    <span class="k">return</span> <span class="n">SEQ</span>
                    <span class="c1"># uniprot_entity_dict = self.overall_uniprot_dict[polymer_entity_id]</span>
                    <span class="c1"># if len(uniprot_entity_dict) &lt; 3:</span>
                    <span class="c1">#     middle = each_dict[0]</span>
                    <span class="c1">#     rcsb_uniprot_protein = middle[&#39;rcsb_uniprot_protein&#39;]</span>
                    <span class="c1">#     SEQ = rcsb_uniprot_protein[&#39;sequence&#39;]</span>
                    <span class="c1"># REF_SEQ_POSITIONS_DICT = {&#39;Beginning Position on Cannonical Sequence&#39;: &#39;&#39;, &#39;Ref Sequence Length&#39;: &#39;&#39;}</span>
                    <span class="c1"># if len(polymer_entity_dict) &gt; 3:</span>
                    <span class="c1">#     entity_align = polymer_entity_dict[&#39;rcsb_polymer_entity_align&#39;]</span>
                    <span class="c1">#     middle = entity_align[0]</span>
                    <span class="c1">#     aligned_info = middle[&#39;aligned_regions&#39;]</span>
                    <span class="c1">#     middle2 = aligned_info[0]</span>
                    <span class="c1">#     REF_SEQ_POSITIONS_DICT[&#39;Beginning Position on Cannonical Sequence&#39;] = middle2[&#39;ref_beg_seq_id&#39;]</span>
                    <span class="c1">#     REF_SEQ_POSITIONS_DICT[&#39;Ref Sequence Length&#39;] = middle2[&#39;length&#39;]</span>
                    <span class="c1"># beg_number = REF_SEQ_POSITIONS_DICT[&#39;Beginning Position on Cannonical Sequence&#39;]-1</span>
                    <span class="c1"># end_number = beg_number + REF_SEQ_POSITIONS_DICT[&#39;Ref Sequence Length&#39;]</span>
                    <span class="c1"># return SEQ[beg_number:end_number]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;not found&#39;</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span> <span class="s1">&#39;entity_beg_seq_id&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polymer_entity_dict</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">entity_align</span> <span class="o">=</span> <span class="n">polymer_entity_dict</span><span class="p">[</span><span class="s1">&#39;rcsb_polymer_entity_align&#39;</span><span class="p">]</span>
                        <span class="n">middle</span> <span class="o">=</span> <span class="n">entity_align</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">aligned_info</span> <span class="o">=</span> <span class="n">middle</span><span class="p">[</span><span class="s1">&#39;aligned_regions&#39;</span><span class="p">]</span>
                        <span class="n">middle2</span> <span class="o">=</span> <span class="n">aligned_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">middle2</span><span class="p">[</span><span class="s1">&#39;entity_beg_seq_id&#39;</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;not found&#39;</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span> <span class="s1">&#39;ref_beg_seq_id&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polymer_entity_dict</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">entity_align</span> <span class="o">=</span> <span class="n">polymer_entity_dict</span><span class="p">[</span><span class="s1">&#39;rcsb_polymer_entity_align&#39;</span><span class="p">]</span>
                        <span class="n">middle</span> <span class="o">=</span> <span class="n">entity_align</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">aligned_info</span> <span class="o">=</span> <span class="n">middle</span><span class="p">[</span><span class="s1">&#39;aligned_regions&#39;</span><span class="p">]</span>
                        <span class="n">middle2</span> <span class="o">=</span> <span class="n">aligned_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">middle2</span><span class="p">[</span><span class="s1">&#39;ref_beg_seq_id&#39;</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;not found&#39;</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span> <span class="s1">&#39;aligned_regions_length&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polymer_entity_dict</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">entity_align</span> <span class="o">=</span> <span class="n">polymer_entity_dict</span><span class="p">[</span><span class="s1">&#39;rcsb_polymer_entity_align&#39;</span><span class="p">]</span>
                        <span class="n">middle</span> <span class="o">=</span> <span class="n">entity_align</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">aligned_info</span> <span class="o">=</span> <span class="n">middle</span><span class="p">[</span><span class="s1">&#39;aligned_regions&#39;</span><span class="p">]</span>
                        <span class="n">middle2</span> <span class="o">=</span> <span class="n">aligned_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">middle2</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">]</span> <span class="p">)</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;not found&#39;</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span> <span class="s1">&#39;pdbx_gene_src_scientific_name&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span>  <span class="nb">len</span><span class="p">(</span><span class="n">polymer_entity_dict</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">entity_src_gen</span> <span class="o">=</span> <span class="n">polymer_entity_dict</span><span class="p">[</span><span class="s1">&#39;entity_src_gen&#39;</span><span class="p">]</span>
                        <span class="n">middle</span> <span class="o">=</span> <span class="n">entity_src_gen</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">species</span> <span class="o">=</span> <span class="n">middle</span><span class="p">[</span><span class="s1">&#39;pdbx_gene_src_scientific_name&#39;</span><span class="p">]</span>
                    <span class="k">return</span> <span class="n">species</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;not found&#39;</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span> <span class="s1">&#39;mutations exist (Y/N)&#39;</span><span class="p">):</span>
                <span class="n">mutation_count</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polymer_entity_dict</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">entity_poly</span> <span class="o">=</span> <span class="n">polymer_entity_dict</span><span class="p">[</span><span class="s1">&#39;entity_poly&#39;</span><span class="p">]</span>
                    <span class="n">mutation_count</span> <span class="o">=</span> <span class="n">entity_poly</span><span class="p">[</span><span class="s1">&#39;rcsb_mutation_count&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">mutation_count</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;Y&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;N&#39;</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span><span class="s1">&#39;rcsb_mutation_count&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polymer_entity_dict</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">entity_poly</span> <span class="o">=</span> <span class="n">polymer_entity_dict</span><span class="p">[</span><span class="s1">&#39;entity_poly&#39;</span><span class="p">]</span>
                    <span class="n">mutation_count</span> <span class="o">=</span> <span class="n">entity_poly</span><span class="p">[</span><span class="s1">&#39;rcsb_mutation_count&#39;</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">mutation_count</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span><span class="s1">&#39;modifications locations&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polymer_entity_dict</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">locations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_mod_locations</span><span class="p">(</span><span class="n">polymer_entity_id</span><span class="o">=</span><span class="n">polymer_entity_id</span><span class="p">)</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">locations</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                            <span class="k">return</span> <span class="s1">&#39;; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">locations</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">return</span> <span class="s1">&#39;N/A&#39;</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;N/A&#39;</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span><span class="s1">&#39;modifications&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polymer_entity_dict</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">types</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_mod_types</span><span class="p">(</span><span class="n">polymer_entity_id</span><span class="o">=</span><span class="n">polymer_entity_id</span><span class="p">)</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">types</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                            <span class="k">return</span> <span class="s1">&#39;; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">types</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">return</span> <span class="s1">&#39;N/A&#39;</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;N/A&#39;</span>                
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span><span class="s1">&#39;mutations locations&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polymer_entity_dict</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">polymer_entity</span> <span class="o">=</span> <span class="n">polymer_entity_dict</span><span class="p">[</span><span class="s1">&#39;rcsb_polymer_entity&#39;</span><span class="p">]</span>
                        <span class="n">mutation</span> <span class="o">=</span> <span class="n">polymer_entity</span><span class="p">[</span><span class="s1">&#39;pdbx_mutation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>
                        <span class="n">locations</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">mutation</span><span class="p">:</span>
                            <span class="n">locations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">:(</span><span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
                        <span class="n">location</span> <span class="o">=</span> <span class="s1">&#39;; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">locations</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">location</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;N/A&#39;</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span> <span class="s1">&#39;pdbx_mutation joined&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polymer_entity_dict</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">polymer_entity</span> <span class="o">=</span> <span class="n">polymer_entity_dict</span><span class="p">[</span><span class="s1">&#39;rcsb_polymer_entity&#39;</span><span class="p">]</span>
                        <span class="n">mutation</span> <span class="o">=</span> <span class="n">polymer_entity</span><span class="p">[</span><span class="s1">&#39;pdbx_mutation&#39;</span><span class="p">]</span>
                    <span class="k">return</span> <span class="n">mutation</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;N/A&#39;</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span><span class="s1">&#39;deposit_date&#39;</span><span class="p">):</span>
                <span class="n">summary</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry_dict</span><span class="p">[</span><span class="s1">&#39;rcsb_accession_info&#39;</span><span class="p">]</span>
                <span class="n">DEPOSITED_DATE</span> <span class="o">=</span> <span class="n">summary</span><span class="p">[</span><span class="s1">&#39;deposit_date&#39;</span><span class="p">][:</span><span class="mi">10</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">DEPOSITED_DATE</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span> <span class="s1">&#39;audit_author_name&#39;</span><span class="p">):</span> <span class="c1">#fixed</span>
                <span class="n">AUTHORS_LIST</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">temp_authors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry_dict</span><span class="p">[</span><span class="s1">&#39;audit_author&#39;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">temp_authors</span><span class="p">:</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="n">each</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                    <span class="n">AUTHORS_LIST</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="n">final_string</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">AUTHORS_LIST</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">final_string</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span> <span class="s1">&#39;title&#39;</span><span class="p">):</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry_dict</span><span class="p">[</span><span class="s1">&#39;rcsb_primary_citation&#39;</span><span class="p">]</span>
                <span class="n">TITLE</span> <span class="o">=</span> <span class="n">citation</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">TITLE</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span><span class="s1">&#39;pdbx_database_id_doi&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">citation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry_dict</span><span class="p">[</span><span class="s1">&#39;rcsb_primary_citation&#39;</span><span class="p">]</span>
                    <span class="n">DOI</span> <span class="o">=</span> <span class="n">citation</span><span class="p">[</span><span class="s1">&#39;pdbx_database_id_doi&#39;</span><span class="p">]</span>
                    <span class="k">return</span> <span class="n">DOI</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">citation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry_dict</span><span class="p">[</span><span class="s1">&#39;citation&#39;</span><span class="p">]</span>
                        <span class="n">middle</span> <span class="o">=</span> <span class="n">citation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">DOI</span> <span class="o">=</span> <span class="n">middle</span><span class="p">[</span><span class="s1">&#39;pdbx_database_id_doi&#39;</span><span class="p">]</span>
                    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                        <span class="k">return</span> <span class="s1">&#39;not found&#39;</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span><span class="s1">&#39;pdbx_database_id_pub_med&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">citation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry_dict</span><span class="p">[</span><span class="s1">&#39;rcsb_primary_citation&#39;</span><span class="p">]</span>
                    <span class="n">PUBMED_ID</span> <span class="o">=</span> <span class="n">citation</span><span class="p">[</span><span class="s1">&#39;pdbx_database_id_pub_med&#39;</span><span class="p">]</span>
                    <span class="k">return</span> <span class="n">PUBMED_ID</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">citation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry_dict</span><span class="p">[</span><span class="s1">&#39;citation&#39;</span><span class="p">]</span>
                        <span class="n">middle</span> <span class="o">=</span> <span class="n">citation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">DOI</span> <span class="o">=</span> <span class="n">middle</span><span class="p">[</span><span class="s1">&#39;pdbx_database_id_PubMed&#39;</span><span class="p">]</span>
                    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                        <span class="k">return</span> <span class="s1">&#39;not found&#39;</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">==</span> <span class="s2">&quot;pdbx_description&quot;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polymer_entity_dict</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">rcsb_polymer_entity</span> <span class="o">=</span> <span class="n">polymer_entity_dict</span><span class="p">[</span><span class="s1">&#39;rcsb_polymer_entity&#39;</span><span class="p">]</span>
                    <span class="k">return</span> <span class="n">rcsb_polymer_entity</span><span class="p">[</span><span class="s1">&#39;pdbx_description&#39;</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="s1">&#39;N/A&#39;</span></div>
</div>
</div>




<div class="viewcode-block" id="generateStructureRefFile_fromUniprotFile">
<a class="viewcode-back" href="../../PDB.html#CoDIAC.PDB.generateStructureRefFile_fromUniprotFile">[docs]</a>
<span class="k">def</span> <span class="nf">generateStructureRefFile_fromUniprotFile</span><span class="p">(</span><span class="n">uniprotRefFile</span><span class="p">,</span> <span class="n">outputFile</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Creates a PDB Structure Reference File</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">        uniprotRefFile: str</span>
<span class="sd">            Location of the uniprot referenct to use</span>
<span class="sd">        outputFile: str</span>
<span class="sd">            name of the output file</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        Writes to the outputFile location a CSV formatted, annotated structure file</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1">#check that a uniprotRefFile exists</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">uniprotRefFile</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ERROR: </span><span class="si">%s</span><span class="s2"> cannot be found&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">uniprotRefFile</span><span class="p">))</span>
        <span class="k">return</span>
    <span class="n">uniprot_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">uniprotRefFile</span><span class="p">)</span>
    <span class="n">PDB_IDs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">uniprot_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">pdbs_col</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;PDB IDs&#39;</span><span class="p">]</span>
   
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pdbs_col</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">pdbs</span> <span class="o">=</span> <span class="n">pdbs_col</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">pdb_id</span> <span class="ow">in</span> <span class="n">pdbs</span><span class="p">:</span>
                <span class="n">PDB_IDs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pdb_id</span><span class="p">)</span>
    <span class="c1">#print(&quot;DEBUG: PDB IDs&quot;)</span>
    <span class="c1">#print(PDB_IDs)</span>
    <span class="n">generateStructureRefFile</span><span class="p">(</span><span class="n">PDB_IDs</span><span class="p">,</span> <span class="n">outputFile</span><span class="p">)</span>    </div>



<div class="viewcode-block" id="generateStructureRefFile">
<a class="viewcode-back" href="../../PDB.html#CoDIAC.PDB.generateStructureRefFile">[docs]</a>
<span class="k">def</span> <span class="nf">generateStructureRefFile</span><span class="p">(</span><span class="n">PDB_IDs</span><span class="p">,</span> <span class="n">outputFile</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Creates a PDB Structure Reference File</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">        PDB_IDs : a list of PDB IDs</span>
<span class="sd">        outputFile : name of the output file</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        .csv Structure reference file with relevant metadata</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">interface</span> <span class="o">=</span> <span class="n">PDB_interface</span><span class="p">(</span><span class="n">PDB_IDs</span><span class="p">)</span>
    <span class="n">interface</span><span class="o">.</span><span class="n">print_output_csv</span><span class="p">(</span><span class="n">outputFile</span><span class="p">)</span>
    <span class="c1">#interface.get_output_xlsx(outputFile)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Structure Reference File successfully created!&#39;</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="download_cifFile">
<a class="viewcode-back" href="../../PDB.html#CoDIAC.PDB.download_cifFile">[docs]</a>
<span class="k">def</span> <span class="nf">download_cifFile</span><span class="p">(</span><span class="n">PDB_list</span><span class="p">,</span> <span class="n">PATH</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;generates .cif files for PDB structures</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">        PDB_list : list of PDB IDs </span>
<span class="sd">        PATH : path to the store the .cif file</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        .cif files to the path specified&#39;&#39;&#39;</span>
    
    <span class="k">for</span> <span class="n">PDB_ID</span> <span class="ow">in</span> <span class="n">PDB_list</span><span class="p">:</span>
        
        <span class="n">response</span><span class="o">=</span><span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;https://files.rcsb.org/view/</span><span class="si">{</span><span class="n">PDB_ID</span><span class="si">}</span><span class="s1">.cif&#39;</span><span class="p">)</span>
        <span class="n">cif_path</span> <span class="o">=</span> <span class="n">PATH</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">PDB_ID</span><span class="o">+</span><span class="s1">&#39;.cif&#39;</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">cif_path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">cif_path</span></div>

</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">CoDIAC 1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">CoDIAC.PDB</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2023, Naegle Lab.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>